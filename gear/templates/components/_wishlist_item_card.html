{% load gear_filters %}
<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}" />
<div class="relative">
  <a href="{% url 'gear:item_detail' item.id %}" class="card bg-base-100 rounded-xl overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 flex flex-col h-full">
    <figure class="aspect-[4/3] bg-gray-100 overflow-hidden relative flex items-center justify-center">
      <img src="{{ item.get_first_image }}" alt="{{ item.title }}" class="max-w-full max-h-full object-contain" />
      {% if item.status == 'rented_out' %}
        <div class="absolute top-4 left-4 badge badge-error text-xs font-medium">Rented Out</div>
      {% elif item.available_quantity > 0 %}
        <div class="absolute top-4 left-4 badge badge-success text-xs font-medium text-white">Available</div>
      {% endif %}
    </figure>

    <div class="card-body p-6 flex flex-col justify-between">
      <div>
        <div class="flex justify-between items-start mb-2">
          <div class="badge badge-outline text-xs font-bold text-success border-emerald-200">Item</div>
          <div class="flex items-center">
            <span class="text-yellow-500 mr-1"><i class="bi bi-star-fill"></i></span>
            <span class="text-sm font-medium">{{ item.current_rating }}</span>
          </div>
        </div>

        <h2 class="card-title text-lg font-bold mb-2">{{ item.title }}</h2>
        <p class="text-sm text-gray-600 mb-3">{{ item.description|truncatechars:80 }}</p>
      </div>

      <div class="mt-4 text-xs">
        <div class="grid grid-cols-2 gap-2">
          <div class="flex items-center">
            <i class="bi bi-geo-alt text-success mr-1"></i>
            {{ item.location|title }}
          </div>
          <div class="flex items-center justify-end">
            <i class="bi bi-hash text-success mr-1"></i>
            Qty: {{ item.available_quantity }}/{{ item.quantity }}
          </div>
        </div>
      </div>
    </div>
  </a>
  <div class="absolute top-2 right-2 z-10">
    <form method="POST" action="{% url 'users:remove_from_wishlist' item.id %}">
      {% csrf_token %}
      <button type="submit" class="btn btn-sm btn-ghost hover:bg-red-500 hover:text-white text-base">
        <i class="bi bi-trash"></i>
      </button>
    </form>
  </div>
</div>
